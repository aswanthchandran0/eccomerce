<%- include('../layout/header.ejs')-%>
<% currentPage = 'Branding' %>
<!-- <link rel="stylesheet" href="/assets/css/adminSidePagination.css"> -->


   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
<div class="container-scroller">
  <!-- partial:partials/_sidebar.html -->
  <%- include('../layout/sideBar.ejs') -%>
  <div class="container-fluid page-body-wrapper   bg-dark">
    <!-- partial:partials/_navbar.html -->
    <!-- partial -->
    <div class="main-panel ">
      <div class="content-wrapper  ">

        <div class="row">
          <div class="col-md-12 grid-margin stretch-card">
            <div class="card  bg-dark">
              <div class="card-body">
                <div class="d-flex justify-content-between mb-3">
                  <h4 class="card-title">Banner</h4>

                  <div class="flex">
                  </div>
                  <button id="addBannerBtn" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addBanner">
                    + Add
                  </button>

                </div>

                <div class="table-container ">
                  <% if (banners && banners.length > 0) { %>
                  <table class="table  align-middle">
                    <thead class="table-dark text-center">
                      <tr>
                        <th>No</th>
                        <th>Image</th>
                        <th>eyebrow Text</th>
                        <th>headline</th>
                        <th>subHeadline</th>
                        <th>callToAction</th>
                        <th>Action</th>

                      </tr>
                    </thead>
                    <tbody class="table-dark text-center" id="list">
                      <% banners.forEach((banner, index) => { %>
                      <tr>
                        <td><%= (pagination.page - 1) * pagination.limit + index + 1 %></td>
                        <td style="width: 100px; height: 100px;">
                          <img src="<%= banner.image %>" alt="Banner Image" style="width: 100%; height: 100%; object-fit: cover; border-radius: 0;">
                        </td>
                        <td class="text-truncate" style="max-width: 200px;" title="<%= banner.eyebrowText  %>">
                          <%= banner.eyebrowText || "—" %>
                        </td>

                        <td class="text-truncate" style="max-width: 200px;" title="<%= banner.headline %>">
                          <%= banner.headline || "—" %>
                        </td>

                        <td class="text-truncate" style="max-width: 200px;" title="<%= banner.subHeadline %>">
                          <%= banner.subHeadline || "—" %>
                        </td>

                        <td class="text-truncate" style="max-width: 200px;" title="<%=banner.callToAction%>">
                          <%= banner.callToAction || "—" %>
                        </td>



                      <td class="text-center">
 <button class="btn btn-sm btn-warning editBannerBtn"
        data-bs-toggle="modal"
        data-bs-target="#editBannerModal"
        data-banner='<%= JSON.stringify(banner) %>'>
  Edit
</button>

 <!-- Example delete button inside your banner card/table -->
<button 
  class="btn btn-sm btn-danger delete-banner-btn" 
  data-id="<%= banner._id %>" 
  data-bs-toggle="modal" 
  data-bs-target="#deleteBannerModal">
  Delete
</button>


</td>





                      </tr>

                      <% }) %>
                    </tbody>
                  </table>
                  <% } else { %>
                  <div class="alert alert-info text-center">No banners found. Add a new banner to get started.</div>
                  <% } %>
                </div> <!-- table-container -->
              </div> <!-- card-body -->


            </div> <!-- card -->



          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- main-panel ends -->
</div>
<!-- page-body-wrapper ends -->
</div>




<%-include('./modals/edit') %>
<%- include('./modals/add') %>
<%- include('./modals/delete') %>




<script>
const editBannerModal = document.getElementById('editBannerModal');

editBannerModal.addEventListener('show.bs.modal', (event) => {
  const button = event.relatedTarget; // button that triggered the modal
  const banner = JSON.parse(button.getAttribute('data-banner'));

  document.getElementById('editBannerId').value = banner._id;
  document.getElementById('editEyebrowText').value = banner.eyebrowText;
  document.getElementById('editHeadline').value = banner.headline;
  document.getElementById('editSubHeadline').value = banner.subHeadline;
  document.getElementById('editCallToAction').value = banner.callToAction;
  document.getElementById('editUrl').value = banner.url;

  // Clear previous errors
  ["editEyebrowText","editHeadline","editSubHeadline","editCallToAction","editUrl"].forEach(id => {
    document.getElementById(id + "Error").innerText = "";
  });
});

</script>





<%- include('../layout/footer.ejs')-%>