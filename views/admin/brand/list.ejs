<%- include('../layout/header.ejs')-%>
<% currentPage = 'Branding' %>
<!-- <link rel="stylesheet" href="/assets/css/adminSidePagination.css"> -->


<div class="container-scroller">
  <!-- partial:partials/_sidebar.html -->
  <%- include('../layout/sideBar.ejs') -%>
  <div class="container-fluid page-body-wrapper">
    <!-- partial:partials/_navbar.html -->
    <!-- partial -->
    <div class="main-panel">
      <div class="content-wrapper">

        <div class="row">
          <div class="col-md-12 grid-margin stretch-card">
            <div class="card">
              <div class="card-body">
                <div class="d-flex justify-content-between mb-3">
                  <h4 class="card-title">Brand</h4>

                  <div class="flex">
                    <%-include("../../partials/search.ejs") -%>
                  </div>
                  <button id="addButton" class="btn btn-primary btn-sm">Add</button>
                </div>

                <div class="table-container">
                  <% if (brands && brands.length > 0) { %>
                  <table class="table  align-middle">
                    <thead class="table-dark text-center">
                      <tr>
                        <th>No</th>
                        <th>Brand Name</th>
                        <th>Description</th>
                        <th>Status</th>
                        <th>Date Created</th>
                        <th>Last Updated</th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody id="list">
                      <% brands.forEach((brand, index) => { %>
                      <tr>
                        <td><%= (pagination.page - 1) * pagination.limit + index + 1 %></td>
                        <td><%= brand.name %></td>
                        <td class="text-truncate" style="max-width: 200px;" title="<%= brand.description %>">
                          <%= brand.description || "â€”" %>
                        </td>
                        <td>
                          <% if (brand.is_active) { %>
                          <span class="text-success">Active</span>
                          <% } else { %>
                          <span class="text-danger">Blocked</span>
                          <% } %>
                        </td>
                        <td><%= brand.createdAt.toLocaleDateString() %></td>
                        <td><%= brand.updatedAt.toLocaleDateString() %></td>
                        <td class="text-center">
                          <button class="btn btn-sm btn-warning" onclick="toggleEditBrandModal('<%= brand._id %>')">Edit</button>
                          <button class="btn btn-sm <%= brand.is_active ? 'btn-danger' : 'btn-success' %>" onclick="toggleStatusModal('<%= brand._id %>')">
                            <%= brand.is_active ? 'Block' : 'Unblock' %>
                          </button>
                        </td>

                      </tr>
                      <%- include("./modals/edit", { brand: brand }) %>
                      <%- include('./modals/status', { brand: brand }) %>
                      <% }) %>
                    </tbody>
                  </table>
                  <% } else { %>
                  <div class="alert alert-info text-center">No brands found. Add a new brand to get started.</div>
                  <% } %>
                </div> <!-- table-container -->
              </div> <!-- card-body -->
         
            <%-include('../../partials/pagination.ejs') -%>


            </div> <!-- card -->

     

          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- main-panel ends -->
</div>
<!-- page-body-wrapper ends -->
</div>
<%- include('./modals/add') %>



<script>
  //block modal
  function toggleStatusModal(brandId) {
    const modal = document.getElementById(`statusBrandModal-${brandId}`);
    const overlay = document.getElementById(`statusBrandOverlay-${brandId}`);
    console.log("button clicked for toggle block button")

    if (modal.style.display === "none") {
      modal.style.display = "block";
      overlay.style.display = "block";
    } else {
      modal.style.display = "none";
      overlay.style.display = "none";
    }
  }
</script>

<script>
  // edit modal
  function toggleEditBrandModal(brandId) {
    const modal = document.getElementById(`editBrandModal-${brandId}`);
    const overlay = document.getElementById(`editBrandOverlay-${brandId}`);
    console.log("button clicked for toggle edit button")
    if (modal.style.display === "none") {
      modal.style.display = "block";
      overlay.style.display = "block";
    } else {
      modal.style.display = "none";
      overlay.style.display = "none";
    }
  }
</script>


<script>
  // add modal

  // open modal
  document.getElementById('addButton').addEventListener('click', () => {
    document.getElementById("addBrand").style.display = "block"
    console.log(
      'button was clicked'
    )
    // close modal 
    document.getElementById('cancelBrandCreation').addEventListener('click', () => {
      document.getElementById("addBrand").style.display = "none"
    })
  })
</script>




<script src="/assets/js/pagination.js"></script>
<%- include('../layout/footer.ejs')-%>